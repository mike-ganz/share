<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orderly - Returns Assistant</title>
    <link rel="icon" type="image/png" href="images/orderly_icon_white_square.png">
    
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-16502156015"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'AW-16502156015');
    </script>

    <!-- Event snippet for App Store conversion page -->
    <script>
      gtag('event', 'conversion', {'send_to': 'AW-16502156015/XFSYCO3MjbsZEO_V67w9'});
    </script>
</head>
<body>
    <script>
        const ua = navigator.userAgent || navigator.vendor;
        const isAndroid = /android/i.test(ua);
        const isiOS = /iPad|iPhone|iPod/.test(ua);

        function doRedirect() {
            const baseUrl = 'orderly://';
            const params = new URLSearchParams(window.location.search);
            const path = params.get('path');
            const additionalParams = params.toString().replace(`path=${path}&`, '').replace(`path=${path}`, '');
            const deepLink = baseUrl + (path ? path + (additionalParams ? '?' + additionalParams : '') : '');

            window.location.href = deepLink;

            setTimeout(() => {
                if (isiOS) {
                    window.location.href = 'https://apps.apple.com/us/app/orderly-returns-assistant/id6452804073';
                } else if (isAndroid) {
                    const intentUri = `intent://${path || ''}${additionalParams ? '?' + additionalParams : ''}#Intent;scheme=orderly;package=com.orderly.android;end`;
                    window.location.href = intentUri;
                } else {
                    window.location.href = 'https://apps.apple.com/us/app/orderly-returns-assistant/id6452804073';
                }
            }, 500);
        }

        if (isAndroid) {
            document.write(`
                <div style="display: flex; align-items: center; justify-content: center; height: 100vh;">
                    <button onclick="doRedirect()" style="padding: 1em 2em; font-size: 1.2em;">
                        Tap to open Orderly
                    </button>
                </div>
            `);
        } else {
            window.onload = doRedirect;
        }
    </script>
</body>
</html>
